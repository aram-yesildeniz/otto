!function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var u=function(){function e(){n(this,e),this.tracker=window.o_tracking||{},this.tracker.bct||(this.tracker.bct={sendMergeToTrackingServer:function(){},sendEventToTrackingServer:function(){},submitMove:function(){}})}return o(e,[{key:"sendClickTrackingEvent",value:function(e,t,i,n,r,o,s,a){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=this._buildClickTrackingPayload(e,t,n,r,o,s,a,"click",i,l);this.tracker.bct.submitMove(u)}},{key:"sendViewTrackingEvent",value:function(e,t,i,n,r,o,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l={};l["promo_"+e]=this._getViewTrackingInfo(o,t,n,r,s,a),null!=i&&(l["promo_"+e+"_v2"]=this._getViewTrackingInfoV2(o,t,n,r,s,i,a)),this.tracker.bct.sendMergeToTrackingServer(l)}},{key:"sendViewTrackingEventHidden",value:function(e,t,i,n,r,o,s,a,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c={};c["promo_"+e]=this._getEventAsString(t,n,r,o,a,s,"view",u),c["promo_"+e+"_v2"]=this._getEventAsStringV2(t,n,r,o,a,s,"view",i,u),l&&(c.promo_FeatureInteraction=this._getMovementTrackingInfoAsString(e,n,r,o,l)),this.tracker.bct.sendEventToTrackingServer(c)}},{key:"sendCinemaMovementTrackingEventHidden",value:function(e,t,i,n,r){var o={promo_FeatureInteraction:this._getMovementTrackingInfoAsString(e,t,i,n,r)};this.tracker.bct.sendEventToTrackingServer(o)}},{key:"_getViewTrackingInfo",value:function(e,t,i,n,r,o){for(var s=[],a=0;a<t.length;++a)s.push(this._getEventAsString(t[a],i,n,e,a+1,r[a],"view",o));return s.join("|")}},{key:"_getViewTrackingInfoV2",value:function(e,t,i,n,r,o,s){for(var a=[],l=0;l<o.length;++l)a.push(this._getEventAsStringV2(t[l],i,n,e,l+1,r[l],"view",o[l],s));return a.join("|")}},{key:"_buildClickTrackingPayload",value:function(e,t,i,n,r,o,s,a,l,u){var c={};c["promo_"+e]=this._getEventAsString(t,i,n,r,o,s,a,u),c["promo_"+e+"_v2"]=this._getEventAsStringV2(t,i,n,r,o,s,a,l,u),c["wk.promo_Attribution"]="promo_"+e+"∞"+this._getEventAsString(t,i,n,r,o,s,a,u);var d=document.querySelector(".combo_topic_content"),h=d?d.getAttribute("data-topic-id"):null;return h&&(c["wk.sd_TopicId"]=h),c}},{key:"_getEventAsString",value:function(e,t,i,n,r,o,s,a){return e+(null!=a?"Δ"+a:"")+"∞"+t+"$"+(i+1)+"∞"+n+"∞"+r+"∞"+o+"∞"+s}},{key:"_getEventAsStringV2",value:function(e,t,i,n,r,o,s,a,l){return e+"∞"+t+"$"+(i+1)+"∞"+n+"∞"+r+"∞"+o+"∞"+s+"∞"+a+"∞"+l}},{key:"_getMovementTrackingInfoAsString",value:function(e,t,i,n,r){return e+"∞"+t+"$"+(i+1)+"∞"+n+"∞"+r}}]),e}(),c=function(){function e(){n(this,e),this.trackingService=new u}return o(e,[{key:"trackClick",value:function(e,t,i,n){var r=this.findParentContainer(e,n),o=this.getDestinationUrl(e),s=this.getFeatureOrder(r),a=this.getFeatureIndex(r),l=this.getDestinationDreson(e),u=this.getSource(e),c=this.getPersonalizationContextOfLink(e);this.trackingService.sendClickTrackingEvent(n,o,l,s,a,i,t+1,u,c)}},{key:"getSource",value:function(e){return e.parentElement.getAttribute("data-source")||"manual"}},{key:"getDestinationDreson",value:function(e){return e.parentElement.getAttribute("data-dreson")}},{key:"getDestinationUrl",value:function(e){return e.getAttribute("href")}},{key:"getPersonalizationContextOfLink",value:function(e){return this.getPersonalizationContextOfContainer(e.parentElement.parentElement)}},{key:"getPersonalizationContextOfContainer",value:function(e){return e.getAttribute("data-context")}},{key:"trackInitialViewLargeShopPromo",value:function(e){var t=this.getPromoType(e),i=this.getAllDestinationUrls(e,t),n=this.getFeatureOrder(e),r=this.getSources(e,t),o=r.length,s=this.getFeatureIndex(e);"false"===e.getAttribute("data-isslidingcinemaenabled")?this.trackingService.sendViewTrackingEvent(t,i,null,n,s,o,r):(e.querySelectorAll(".promo_shoppromo-large--item")[0].setAttribute("data-slidetracked","true"),this.trackingService.sendViewTrackingEvent(t,[i[0]],null,n,s,o,[r[0]]))}},{key:"trackInitialViewSmallShopPromo",value:function(e,t){var i=this.getPromoType(e),n=this.getPersonalizationContextOfContainer(e),r=this.getAllDestinationUrls(e,i,0,t),o=this.getAllDestinationDresons(e,i,0,t),s=this.getFeatureOrder(e),a=this.getSources(e,i,0,t),l=this.getSources(e,i).length,u=this.getFeatureIndex(e);this.setTileTracked(e,t),this.trackingService.sendViewTrackingEvent(i,r,o,s,u,l,a,n)}},{key:"trackSlide",value:function(e,t,i){var n=this.getPromoType(e),r=this.getPersonalizationContextOfContainer(e),o=this.getAllDestinationUrls(e,n),s=this.getAllDestinationDresons(e,n),a=this.getFeatureOrder(e),l=this.getSources(e),u=this.getFeatureIndex(e),c=l.length-2;this.trackingService.sendViewTrackingEventHidden(n,o[t],null!=s?s[t]:null,a,u,c,l[t],t,i,r)}},{key:"trackViewOnCinemaMovement",value:function(e,t,i){var n=this,r=this.getPromoType(e),o=this.getPersonalizationContextOfContainer(e),s=this.getAllDestinationUrls(e,r,t,i),a=this.getAllDestinationDresons(e,r,t,i),l=this.getFeatureOrder(e),u=this.getSources(e,r,t,i),c=this.getSources(e,r).length,d=this.getFeatureIndex(e),h=e.querySelectorAll(".promo_shoppromo-small--tile");Array.from(h).slice(t,i).forEach((function(e,t){if("true"!==e.getAttribute("data-tracked")){e.setAttribute("data-tracked","true");var i=parseInt(e.getAttribute("data-index"))+1;n.trackingService.sendViewTrackingEventHidden(r,s[t],a[t],l,d,c,u[t],i,null,o)}}))}},{key:"trackCinemaMovementType",value:function(e,t){var i=this.getPromoType(e),n=this.getFeatureOrder(e),r=this.getSources(e,i).length,o=this.getFeatureIndex(e);this.trackingService.sendCinemaMovementTrackingEventHidden(i,n,o,r,t)}},{key:"getPromoType",value:function(e){return e.getAttribute("data-promo-type")}},{key:"getAllDestinationUrls",value:function(e,t,i,n){var r=this,o="ShopPromotionSmall"===t?".promo_shoppromo-small--tile a":".promo_shoppromo-large--image-container a",s=e.querySelectorAll(o);return i=i||0,n=n||s.length,[].map.call(s,(function(e){return r.getDestinationUrl(e)})).slice(i,n)}},{key:"getAllDestinationDresons",value:function(e,t,i,n){var r=this,o="ShopPromotionSmall"===t?".promo_shoppromo-small--tile a":".promo_shoppromo-large--image-container a",s=e.querySelectorAll(o);return null==s||0===s.length?null:(i=i||0,n=n||s.length,[].map.call(s,(function(e){return r.getDestinationDreson(e)})).slice(i,n))}},{key:"getFeatureOrder",value:function(e){return parseInt(e.parentElement.getAttribute("data-feature-order"),0)}},{key:"getFeatureIndex",value:function(e){return parseInt(e.getAttribute("data-feature-index"),0)}},{key:"getSources",value:function(e,t,i,n){var r="ShopPromotionSmall"===t?".promo_shoppromo-small--tile":".promo_shoppromo-large--image-container",o=e.querySelectorAll(r);return i=i||0,n=n||o.length,[].map.call(o,(function(e){return e.getAttribute("data-source")||"manual"})).slice(i,n)}},{key:"findParentContainer",value:function(e,t){for(var i="ShopPromotionSmall"===t?"promo_shoppromo-small--container":"promo_shoppromo-large--container";!e.classList.contains(i)&&(e=e.parentElement););return e}},{key:"setTileTracked",value:function(e,t){var i=e.querySelectorAll(".promo_shoppromo-small--tile");Array.from(i).slice(0,t).forEach((function(e){return e.setAttribute("data-tracked","true")}))}}],[{key:"loadImages",value:function(e){for(var t=e.querySelectorAll(".promo_shoppromo-large--image"),i=e.querySelectorAll(".promo_shoppromo-large--picture source, .promo_shoppromo-large--overlay source"),n=e.querySelectorAll(".promo_shoppromo-large--logo"),r=0;r<t.length;r++)t[r].getAttribute("data-src")&&t[r].setAttribute("src",t[r].getAttribute("data-src"));for(var o=0;o<i.length;o++)i[o].getAttribute("data-srcset")&&i[o].setAttribute("srcset",i[o].getAttribute("data-srcset"));for(var s=0;s<n.length;s++)n[s].getAttribute("data-src")&&n[s].setAttribute("src",n[s].getAttribute("data-src"))}}]),e}(),d=function(){function e(t){var i=this;n(this,e),this.container=t,this.promoType=this._getPromoType(t),this.featureOrder=this._getFeatureOrder(t),this.featureIndex=this._getFeatureIndex(t),this.items=t.querySelectorAll(".promo_brandshoppromo--image-container a"),this.sourceUrls=this._getSourceUrls(),this.filledSlots=this.items.length,this.trackingService=new u,this.trackView(),[].map.call(this.items,(function(e){e.addEventListener("click",i.trackClick(),!1)}))}return o(e,[{key:"trackClick",value:function(){var e=this;return function(){e.trackingService.sendClickTrackingEvent(e.promoType,this.getAttribute("href"),null,e.featureOrder,e.featureIndex,e.filledSlots,parseInt(this.getAttribute("data-item-index"))+1,"manual")}}},{key:"trackView",value:function(){var e=[].map.call(this.items,(function(e){return e.getAttribute("href")}));this.trackingService.sendViewTrackingEvent(this.promoType,e,null,this.featureOrder,this.featureIndex,this.filledSlots,this.sourceUrls)}},{key:"_getPromoType",value:function(){return this.container.getAttribute("data-promo-type")}},{key:"_getFeatureOrder",value:function(){return parseInt(this.container.parentElement.getAttribute("data-feature-order"),0)}},{key:"_getFeatureIndex",value:function(e){return parseInt(e.getAttribute("data-feature-index"),0)}},{key:"_getSourceUrls",value:function(){var e=this.container.querySelectorAll(".promo_brandshoppromo--image-container");return[].map.call(e,(function(){return"manual"}))}}]),e}(),h=function(){function e(t,i){n(this,e),this.buttonDom=t,this.buttonHideClass=i}return o(e,[{key:"registerOnClickHandler",value:function(e){this.buttonDom.addEventListener("click",e)}},{key:"hide",value:function(){this.buttonDom.classList.contains(this.buttonHideClass)||this.buttonDom.classList.add(this.buttonHideClass)}},{key:"show",value:function(){this.buttonDom.classList.contains(this.buttonHideClass)&&this.buttonDom.classList.remove(this.buttonHideClass)}},{key:"forceVisibility",value:function(){this.buttonDom.style.visibility="visible"}}]),e}(),m=function(){function e(t){n(this,e),this.tileDom=t}return o(e,[{key:"getWidth",value:function(){return this.tileDom.offsetWidth}}]),e}(),v=function(){function e(t,i){n(this,e),this.tileListView=t,this.tiles=i,this.lastTargetTileIndex=-1}return o(e,[{key:"scrollLeft",value:function(e){var t=this.tileListView.fullyVisibleTilesPerPage(),i=this.tileListView.firstVisibleTileIndex(),n=Math.max(0,i-t);this.scrollTo(n,e)}},{key:"scrollRight",value:function(e){var t=this.tileListView.fullyVisibleTilesPerPage(),i=this.tileListView.firstVisibleTileIndex(),n=this.tiles.length-t,r=Math.min(i+t,n);this.scrollTo(r,e)}},{key:"scrollTo",value:function(e,t){e!==this.lastTargetTileIndex&&(this.lastTargetTileIndex=e,this.tileListView.scrollTo(e,t))}},{key:"isAtLeftBorder",value:function(){return this.tileListView.isAtLeftBorder()}},{key:"isAtRightBorder",value:function(){return this.tileListView.isAtRightBorder()}}]),e}(),f=function(){function e(){n(this,e)}return o(e,null,[{key:"group",value:function(e){window.o_global.debug.status().activated&&console.group&&console.group(e)}},{key:"groupEnd",value:function(){window.o_global.debug.status().activated&&console.groupEnd&&console.groupEnd()}},{key:"log",value:function(e){window.o_global.debug.status().activated&&console.log(e)}},{key:"warn",value:function(e){console.warn&&window.o_global.debug.status().activated&&console.warn(e)}},{key:"table",value:function(e){window.o_global.debug.status().activated&&console.table&&console.table(e)}},{key:"count",value:function(e){window.o_global.debug.status().activated&&console.count&&console.count(e)}}]),e}(),g=function(){function e(t,i,r){var o=this;n(this,e),this.tileContainerDom=t,this.scroller=i,this.tileWidthLambda=r,this.domWrapper={getCurrentScrollPositionPx:function(){return o.tileContainerDom.scrollLeft},setCurrentScrollPositionPx:function(e){o.tileContainerDom.scrollLeft=e},getScrollWidth:function(){return o.tileContainerDom.scrollWidth},getOffsetWidth:function(){return o.tileContainerDom.offsetWidth}}}return o(e,[{key:"registerOnScrollListener",value:function(e){this.tileContainerDom.addEventListener("scroll",e)}},{key:"registerOnTouchStartListener",value:function(e){this.tileContainerDom.addEventListener("touchstart",e,{passive:!0})}},{key:"registerOnTouchEndListener",value:function(e){this.tileContainerDom.addEventListener("touchend",e,{passive:!0})}},{key:"isAtLeftBorder",value:function(){return 0===Math.floor(this.domWrapper.getCurrentScrollPositionPx())}},{key:"isAtRightBorder",value:function(){var e=this.domWrapper.getScrollWidth()-1,t=Math.ceil(this.domWrapper.getCurrentScrollPositionPx())+this.domWrapper.getOffsetWidth();return f.log("rightEdgePosition: "+e+" - currentRightScrollPosition: "+t),e<=t}},{key:"fullyVisibleTilesPerPage",value:function(){var e=this.domWrapper.getOffsetWidth();return Math.floor(e/this.tileWidthLambda())}},{key:"firstVisibleTileIndex",value:function(){var e=this.domWrapper.getCurrentScrollPositionPx();return Math.ceil(e/this.tileWidthLambda())}},{key:"mostVisibleTileIndex",value:function(){var e=this.domWrapper.getCurrentScrollPositionPx();return Math.round(e/this.tileWidthLambda())}},{key:"lastVisibleTileIndex",value:function(){var e=this.domWrapper.getCurrentScrollPositionPx()+this.domWrapper.getOffsetWidth();return Math.round(e/this.tileWidthLambda())-1}},{key:"scrollTo",value:function(e,t){var i=this.stayWithinBoundaries(e*this.tileWidthLambda()),n=this.domWrapper.getCurrentScrollPositionPx();this.scroller.scrollAnimation(n,i,this.domWrapper.setCurrentScrollPositionPx,(function(){t(e)}))}},{key:"stayWithinBoundaries",value:function(e){var t=this.domWrapper.getScrollWidth()-this.domWrapper.getOffsetWidth();return e=Math.max(0,e),e=Math.min(t,e)}}]),e}(),p=function(){function e(t,i){var r=this;n(this,e),this.cinemaDom=t,this.config=i,this.promoShopPromo=window.o_promo_shoppromo;var o=Array.from(t.querySelectorAll(i.tileSelector)).map((function(e){return new m(e)}));this.tiles=o,this.tileListViewDomObject=t.querySelector(i.containerSelector),this.tileListView=new g(this.tileListViewDomObject,function(){var e={},t=o_util.animation.easings.easeOutCubic;e.registerAnimationStartedCallback=function(e){setTimeout(e,125)},e.scrollAnimation=function(t,n,r,o){e.registerAnimationStartedCallback(o),i(t,n,r,o)};var i=function e(i,r,o,s){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=(new Date).getTime(),u=(l-(a=0===a?l:a))/500;if(u>1)return o(r),void s();var c=n(i,r,u,t);o(c),o_util.animation.requestAnimFrame((function(){e(i,r,o,s,a)}))},n=function(e,t,i,n){return e-(e-t)*n(i)};return e}(),(function(){return o[0].getWidth()+(i.tilePaddingRight||0)}));var s=this.tileListView;this.tileListController=new v(s,o),window.addEventListener("resize",(function(){return r.updateButtonVisibility()})),this.leftButton=new h(t.querySelector(i.buttonLeftSelector),i.buttonHideClass),this.leftButton.registerOnClickHandler((function(){r.tileListController.scrollLeft((function(){r.updateButtonVisibility()})),r.promoShopPromo.trackCinemaMovementType(r.cinemaDom.parentElement,"left")})),this.rightButton=new h(t.querySelector(i.buttonRightSelector),i.buttonHideClass),this.rightButton.registerOnClickHandler((function(){r.tileListController.scrollRight((function(){r.updateButtonVisibility()})),r.promoShopPromo.trackCinemaMovementType(r.cinemaDom.parentElement,"right")})),s.registerOnScrollListener((function(){r.updateButtonVisibility(),r.promoShopPromo.trackViewOnCinemaMovement(r.cinemaDom.parentElement,s.mostVisibleTileIndex(),s.lastVisibleTileIndex()+1)})),s.registerOnTouchStartListener((function(){r.isScrolling=!0})),s.registerOnTouchEndListener((function(){r.isScrolling=!1,r.promoShopPromo.trackCinemaMovementType(r.cinemaDom.parentElement,"swipe")})),this.addMouseMovementListenerForHybridDevices(),this.waitForCss()}return o(e,[{key:"waitForCss",value:function(){var e=this,t=this,i=window.setInterval((function(){var n=t.tileListViewDomObject.scrollWidth,r=t.tileListViewDomObject.getBoundingClientRect().width||t.tileListViewDomObject.offsetWidth,o=e.tiles[e.tiles.length-1].getWidth();f.log("Small Cinema - scrollWidth: "+n+" - offsetWidth: "+r+" - document.hidden: "+document.hidden+" - timestamp: "+Date.now()+" - last tile width: "+o),n>0&&!document.hidden&&o<n&&(f.log("Updating button visibility and clearing interval."),t.updateButtonVisibility(),t.promoShopPromo.trackInitialViewSmallShopPromo(t.cinemaDom.parentElement,t.tileListView.fullyVisibleTilesPerPage()),window.clearInterval(i))}),100)}},{key:"updateButtonVisibility",value:function(){this.tileListController.isAtLeftBorder()?this.leftButton.hide():this.leftButton.show(),this.tileListController.isAtRightBorder()?this.rightButton.hide():this.rightButton.show()}},{key:"addMouseMovementListenerForHybridDevices",value:function(){var e=this,t=function t(){e.leftButton.forceVisibility(),e.rightButton.forceVisibility(),e.cinemaDom.removeEventListener("mouseover",t,!1)};this.cinemaDom.addEventListener("mouseover",t,!1),this.cinemaDom.addEventListener("touchstart",(function i(){e.cinemaDom.removeEventListener("mouseover",t,!1),e.cinemaDom.removeEventListener("touchstart",i,!1)}),{passive:!0})}}]),e}();var y={slidesToScroll:1,slideSpeed:300,rewindSpeed:600,snapBackSpeed:200,ease:"ease",rewind:!1,infinite:!1,initialIndex:0,classNameFrame:"js_frame",classNameSlideContainer:"js_slides",classNamePrevCtrl:"js_prev",classNameNextCtrl:"js_next",classNameActiveSlide:"active",enableMouseEvents:!1,window:"undefined"!=typeof window?window:null,rewindOnResize:!0},b=Array.prototype.slice;function k(e,t){var n,r,o,s,a,u,c,d,h,m,v,f,g,p=0,k={},S=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return e}()&&{passive:!0};function w(e,t){var i=k.classNameActiveSlide;e.forEach((function(e,t){e.classList.contains(i)&&e.classList.remove(i)})),e[t].classList.add(i)}function L(t,n,r){!function(e,t,n){var r=new i(t,{bubbles:!0,cancelable:!0,detail:n});e.dispatchEvent(r)}(e,"".concat(t,".lory.").concat(n),r)}function C(e,t,i){var n=u&&u.style;n&&(n[h.transition+"TimingFunction"]=i,n[h.transition+"Duration"]=t+"ms",n[h.transform]="translateX("+e+"px)")}function E(e){return e.getBoundingClientRect().width||e.offsetWidth}function A(e,t){var i=k,a=i.slideSpeed,l=i.slidesToScroll,u=i.infinite,h=i.rewind,v=i.rewindPrev,f=i.rewindSpeed,g=i.ease,y=i.classNameActiveSlide,S=i.classNameDisabledNextCtrl,E=void 0===S?"disabled":S,A=i.classNameDisabledPrevCtrl,_=void 0===A?"disabled":A,D=a,T=t?p+1:p-1,x=Math.round(r-o);L("before","slide",{index:p,nextSlide:T}),c&&c.classList.remove(_),d&&d.classList.remove(E),"number"!=typeof e&&(e=t?u&&p+2*u!==s.length?p+(u-p%u):p+l:u&&p%u!=0?p-p%u:p-l),e=Math.min(Math.max(e,0),s.length-1),u&&void 0===t&&(e+=u),v&&0===Math.abs(n.x)&&!1===t&&(e=s.length-1,D=f);var P=Math.min(Math.max(-1*s[e].offsetLeft,-1*x),0);h&&Math.abs(n.x)===x&&t&&(P=0,e=0,D=f),C(P,D,g),n.x=P,s[e].offsetLeft<=x&&(p=e),!u||e!==s.length-u&&e!==s.length-s.length%u&&0!==e||(t&&(p=u),t||(p=s.length-2*u),n.x=-1*s[p].offsetLeft,m=function(){C(-1*s[p].offsetLeft,0,void 0)}),y&&w(b.call(s),p),!c||u||v||0!==e||c.classList.add(_),!d||u||h||e+1!==s.length||d.classList.add(E),L("after","slide",{currentSlide:p})}function _(){var i,r,o,m,v,f;L("before","init"),v=document.createElement("_"),""===(f=v.style)[m="webkitTransition"]&&(o="webkitTransitionEnd",r=m),""===f[m="transition"]&&(o="transitionend",r=m),""===f[m="webkitTransform"]&&(i=m),""===f[m="msTransform"]&&(i=m),""===f[m="transform"]&&(i=m),document.body.insertBefore(v,null),f[i]="translateX(0)",document.body.removeChild(v),h={transform:i,transition:r,transitionEnd:o};var g,C,E,A,_=k=l(l({},y),t),O=_.classNameFrame,M=_.classNameSlideContainer,B=_.classNamePrevCtrl,F=_.classNameNextCtrl,N=_.classNameDisabledNextCtrl,q=void 0===N?"disabled":N,j=_.classNameDisabledPrevCtrl,H=void 0===j?"disabled":j,z=_.enableMouseEvents,R=_.classNameActiveSlide,U=_.initialIndex;p=U,a=e.getElementsByClassName(O)[0],u=a.getElementsByClassName(M)[0],c=e.getElementsByClassName(B)[0],d=e.getElementsByClassName(F)[0],n={x:u.offsetLeft,y:u.offsetTop},k.infinite?(g=b.call(u.children),C=k.infinite,E=g.slice(0,C),A=g.slice(g.length-C,g.length),E.forEach((function(e){var t=e.cloneNode(!0);u.appendChild(t)})),A.reverse().forEach((function(e){var t=e.cloneNode(!0);u.insertBefore(t,u.firstChild)})),u.addEventListener(h.transitionEnd,P),s=b.call(u.children)):(s=b.call(u.children),c&&!k.rewindPrev&&c.classList.add(H),d&&1===s.length&&!k.rewind&&d.classList.add(q)),D(),R&&w(s,p),c&&d&&(c.addEventListener("click",T),d.addEventListener("click",x)),a.addEventListener("touchstart",I,S),z&&(a.addEventListener("mousedown",I),a.addEventListener("click",V)),k.window.addEventListener("resize",W),L("after","init")}function D(){var e=k,t=e.infinite,i=e.ease,l=e.rewindSpeed,c=e.rewindOnResize,d=e.classNameActiveSlide,h=e.initialIndex;r=E(u),o=E(a),function(e,t,i){return Math.abs(e-t)<i}(r,o,.99)&&(r=s.reduce((function(e,t){return e+E(t)}),0)),c?p=h:(i=null,l=0),t?(C(-1*s[p+t].offsetLeft,0,null),p+=t,n.x=-1*s[p].offsetLeft):(C(-1*s[p].offsetLeft,l,i),n.x=-1*s[p].offsetLeft),d&&w(b.call(s),p)}function T(){A(!1,!1)}function x(){A(!1,!0)}function P(){m&&(m(),m=void 0)}function I(e){var t=k.enableMouseEvents,i=e.touches?e.touches[0]:e;t&&(a.addEventListener("mousemove",O),a.addEventListener("mouseup",M),a.addEventListener("mouseleave",M)),a.addEventListener("touchmove",O,S),a.addEventListener("touchend",M);var n=i.pageX,r=i.pageY;v={x:n,y:r,time:Date.now()},g=void 0,f={},L("on","touchstart",{event:e})}function O(e){var t=e.touches?e.touches[0]:e,i=t.pageX,r=t.pageY;f={x:i-v.x,y:r-v.y},void 0===g&&(g=!!(g||Math.abs(f.x)<Math.abs(f.y))),!g&&v&&C(n.x+f.x,0,null),L("on","touchmove",{event:e})}function M(e){var t=v?Date.now()-v.time:void 0,i=Number(t)<300&&Math.abs(f.x)>25||Math.abs(f.x)>o/3,r=!p&&f.x>0||p===s.length-1&&f.x<0,l=f.x<0;g||(i&&!r?A(!1,l):C(n.x,k.snapBackSpeed)),v=void 0,a.removeEventListener("touchmove",O),a.removeEventListener("touchend",M),a.removeEventListener("mousemove",O),a.removeEventListener("mouseup",M),a.removeEventListener("mouseleave",M),L("on","touchend",{event:e})}function V(e){f.x&&e.preventDefault()}function W(e){o!==E(a)&&(D(),L("on","resize",{event:e}))}return"undefined"!=typeof jQuery&&e instanceof jQuery&&(e=e[0]),_(),{setup:_,reset:D,slideTo:function(e){A(e)},returnIndex:function(){return p-k.infinite||0},prev:T,next:x,destroy:function(){L("before","destroy"),a.removeEventListener(h.transitionEnd,P),a.removeEventListener("touchstart",I,S),a.removeEventListener("touchmove",O,S),a.removeEventListener("touchend",M),a.removeEventListener("mousemove",O),a.removeEventListener("mousedown",I),a.removeEventListener("mouseup",M),a.removeEventListener("mouseleave",M),a.removeEventListener("click",V),k.window.removeEventListener("resize",W),c&&c.removeEventListener("click",T),d&&d.removeEventListener("click",x),k.infinite&&Array.apply(null,Array(k.infinite)).forEach((function(){u.removeChild(u.firstChild),u.removeChild(u.lastChild)})),L("after","destroy")},setSlideSpeed:function(e){k.slideSpeed=e}}}var S=function(){function e(t){n(this,e),this.cinemaDom=t,this.xDown=null,this.yDown=null}return o(e,[{key:"init",value:function(){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){var e=this;this.cinemaDom.addEventListener("touchstart",(function(t){return e.handleTouchStart(t)}),{passive:!0}),this.cinemaDom.addEventListener("touchmove",(function(t){return e.handleTouchMove(t)}),{passive:!1})}}},{key:"handleTouchStart",value:function(e){var t=e.touches[0];this.xDown=t.clientX,this.yDown=t.clientY}},{key:"handleTouchMove",value:function(e){if(this.xDown&&this.yDown){var t=e.touches[0].clientX,i=e.touches[0].clientY,n=this.xDown-t,r=this.yDown-i;Math.abs(n)>Math.abs(r)&&e.preventDefault(),this.xDown=null,this.yDown=null}}}]),e}(),w=function(){function e(t){var i=this;n(this,e);var r=this;this.moveEvent="automatic",this.dots=t.querySelectorAll(".promo_shoppromo-large--bubble-container-item"),this.buttons=t.querySelectorAll(".promo_shoppromo-large--arrow-container > div"),this.dot_count=this.dots.length,this.slider=null,this.autoSlideIntervalMillis=5e3,this.lastAutoSlideTimeMillis=0,this.slideSpeed=1500,this.slideSpeedAfterFirstClick=380,this.automaticSlidingIntervalId=null,this.picturecontainers=null,this.lastClickTimeMillis=0,this.cinemaDom=t,this.carouselIosBridge=new S(t),this.promoShopPromo=window.o_promo_shoppromo,this.cinemaDom.addEventListener("before.lory.init",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("on.lory.touchstart",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("after.lory.init",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("after.lory.slide",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("on.lory.resize",(function(e){return r.handleSliderEvent(e,r)})),[].forEach.call(this.buttons,(function(e){return e.addEventListener("click",(function(e){return r.handleClickEvent(e)}))})),this.leftButton=t.querySelector(".promo_shoppromo-large--cinema-button-left"),this.leftButton.addEventListener("click",(function(){return i.moveEvent="left"})),this.rightButton=t.querySelector(".promo_shoppromo-large--cinema-button-right"),this.rightButton.addEventListener("click",(function(){return i.moveEvent="right"})),[].forEach.call(this.dots,(function(e){return e.addEventListener("click",(function(){return i.moveEvent="page_control"}))})),this.addMouseMovementListenerForHybridDevices(),this.initLory(),this.initCarouselWhenCssAndFirstImageAreLoaded(),o_global.shoppromo_carousel=this}return o(e,[{key:"handleSliderEvent",value:function(e){var t=this;if("before.lory.init"===e.type)this.dots[0].classList.add("active");else if("after.lory.init"===e.type)for(var i=0;i<this.dot_count;i++)this.dots[i].addEventListener("click",(function(e){return t.slideTo(e)}));else if("after.lory.slide"===e.type){for(var n=0;n<this.dot_count;n++)this.dots[n].classList.remove("active");this.dots[e.detail.currentSlide-1].classList.add("active"),this.trackSlidingEvent(e)}else if("on.lory.resize"===e.type){for(var r=0;r<this.dot_count;r++)this.dots[r].classList.remove("active");this.dots[0].classList.add("active"),this.slider.reset()}else"on.lory.touchstart"===e.type&&(this.stopAutomaticSliding(),this.moveEvent="swipe",this.slider.setSlideSpeed(t.slideSpeedAfterFirstClick))}},{key:"slideTo",value:function(e){this.stopAutomaticSliding(),this.slider.slideTo(Array.prototype.indexOf.call(this.dots,e.target))}},{key:"trackSlidingEvent",value:function(e){var t=this.cinemaDom.querySelector(".promo_shoppromo-large--item.active");"true"===t.getAttribute("data-slidetracked")&&"automatic"===this.moveEvent||(t.setAttribute("data-slidetracked","true"),this.promoShopPromo.trackSlide(this.cinemaDom,e.detail.currentSlide,this.moveEvent))}},{key:"handleClickEvent",value:function(e){this.stopAutomaticSliding(),this.slider.setSlideSpeed(this.slideSpeedAfterFirstClick);var t=(new Date).getTime();if(this.lastClickTimeMillis+this.slideSpeedAfterFirstClick>=t)return e.preventDefault(),void e.stopImmediatePropagation();this.lastClickTimeMillis=t}},{key:"stopAutomaticSliding",value:function(){null!==this.automaticSlidingIntervalId&&(window.clearInterval(this.automaticSlidingIntervalId),this.automaticSlidingIntervalId=null)}},{key:"addMouseMovementListenerForHybridDevices",value:function(){var e=this,t=function t(){e.leftButton.style.visibility="visible",e.rightButton.style.visibility="visible",e.cinemaDom.removeEventListener("mouseover",t,!1)};this.cinemaDom.addEventListener("mouseover",t,!1),this.cinemaDom.addEventListener("touchstart",(function i(){e.cinemaDom.removeEventListener("mouseover",t,!1),e.cinemaDom.removeEventListener("touchstart",i,!1)}),{passive:!0})}},{key:"initLory",value:function(){this.slider=k(this.cinemaDom,{infinite:1,slideSpeed:this.slideSpeed,classNameFrame:"promo_shoppromo-large--scroll-pane",classNameSlideContainer:"promo_shoppromo-large--item-container",classNamePrevCtrl:"promo_shoppromo-large--cinema-button-left",classNameNextCtrl:"promo_shoppromo-large--cinema-button-right"}),this.carouselIosBridge.init()}},{key:"initCarouselWhenCssAndFirstImageAreLoaded",value:function(){var e=this,t=window.setInterval((function(){var i=getComputedStyle(e.cinemaDom),n=i?i.zIndex:"-42",r=e.cinemaDom.className.indexOf("large--visible")>0,o="-42"===n||n+""=="-42"||r;f.log("Carousel: zIndex: "+n+" - promoAlreadyVisible: "+r+" - isCssLoadedAndApplied: "+o),o&&(f.log("Carousel: Clearing interval "+t+" and call onCssLoaded"),window.clearInterval(t),e.onCssLoaded())}),50)}},{key:"onCssLoaded",value:function(){var e=this,t=this.cinemaDom.querySelectorAll(".promo_shoppromo-large--image-first")[0];if(this.picturecontainers=this.cinemaDom.querySelectorAll(".promo_shoppromo-large--picturecontainer"),!t)return f.log("Carousel: Cinema Shoppromo contains no images - this should not happen."),void this.cinemaDom.classList.add("promo_shoppromo-large--visible");if(c.loadImages(this.cinemaDom),t.complete)f.log("Carousel: First image is complete - calling onCssAndFirstImageLoaded..."),this.resetCarouselWhenWidthIsGreaterZero();else{f.log("Carousel: First image is not complete - registering event listeners for load and error on firstImage: "+t);var i=o_global.device.browser;"MSIE10"===i||"MSIE9"===i?this.resetCarouselWhenWidthIsGreaterZero():(t.addEventListener("load",(function(){return e.resetCarouselWhenWidthIsGreaterZero()})),t.addEventListener("error",(function(){return e.resetCarouselWhenWidthIsGreaterZero()})))}}},{key:"resetCarouselWhenWidthIsGreaterZero",value:function(){var e=this,t=this.cinemaDom.querySelectorAll(".promo_shoppromo-large--item-container")[0],i=t.getBoundingClientRect().width||t.offsetWidth;if(i<=0)var n=window.setInterval((function(){var i=t.getBoundingClientRect().width||t.offsetWidth;f.log("Carousel: width: "+i),i<=0||(f.log("Carousel: width is "+i+" - Clearing interval "+n+" and resetting carousel"),window.clearInterval(n),e.resetCarousel())}),50);else f.log("Carousel: Has right width ("+i+") from the beginning. Resetting carousel."),this.resetCarousel()}},{key:"resetCarousel",value:function(){this.slider.reset(),this.cinemaDom.classList.add("promo_shoppromo-large--visible"),window.localStorage&&"true"===window.localStorage.getItem("stopSlidingCinemaForJLineup")||(this.automaticSlidingIntervalId=window.setInterval(this.performSlide(),this.autoSlideIntervalMillis))}},{key:"performSlide",value:function(){var e=this;return function(){var t=(new Date).getTime(),i=null!=document.getElementById("p_layer");e.lastAutoSlideTimeMillis+e.autoSlideIntervalMillis<=t&&!i&&(e.slider.next(),e.lastAutoSlideTimeMillis=t)}}}]),e}(),L=function(){function e(t){n(this,e),this.slideContainer=t,this.leverContainer=t.querySelector(".promo_shoppromo-large--benefits-container"),this.ctaContainer=t.querySelector(".promo_shoppromo-large--cta-container"),this.leverLoaded=this.leverContainer.getAttribute("data-promo-lever-loaded"),this.promotedDreson=t.getAttribute("data-promo-dreson"),this.featurePositionOfShoppromo=this._getFeatureOrder(),this.teaserPosition=-1,this.pageContextDreson=this._getPageContextDreson()}return o(e,[{key:"setLeverLoaded",value:function(){this.leverContainer.setAttribute("data-promo-lever-loaded","true"),this.leverLoaded=!0}},{key:"_getFeatureOrder",value:function(){for(var e=this.slideContainer;e&&!e.getAttribute("data-feature-order");)e=e.parentElement;return e?parseInt(e.getAttribute("data-feature-order")):-1}},{key:"_getPageContextDreson",value:function(){for(var e=this.slideContainer;e&&!e.getAttribute("data-page-context-dreson");)e=e.parentElement;return e?e.getAttribute("data-page-context-dreson"):""}},{key:"withTeaserPosition",value:function(e){return this.teaserPosition=e,this}}]),e}(),C=function(){function e(){n(this,e)}return o(e,[{key:"init",value:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.querySelectorAll(".promo_shoppromo-large--item"),r=[].map.call(n,(function(e){return new L(e)})),o=i?r.slice(1,r.length-1):r,s=o.filter((function(e){return-1===e.promotedDreson.indexOf("(ref.")})).filter((function(e){return"false"===e.leverLoaded})).map((function(e,i){return t.appendAndGetLeverFor(e.withTeaserPosition(i+1))}));i&&s.length>0&&this.appendLeverToBuffer(r,s)}},{key:"appendLeverToBuffer",value:function(e,t){var i=this,n=e[0],r=e[e.length-1];t[0].then((function(e){e.success&&e.slide.promotedDreson===r.promotedDreson&&i.appendLeverToSlide(e.lever,r,!0)})),t[t.length-1].then((function(e){e.success&&e.slide.promotedDreson===n.promotedDreson&&i.appendLeverToSlide(e.lever,n,!0)}))}},{key:"appendLeverToSlide",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.ctaContainer.style.visibility="hidden";var n=e.cloneNode(!0);if(i){var r=n.querySelector(".benefit_lever.benefit_lever_slideshow");r.setAttribute("data-tracked",!0)}t.leverContainer.appendChild(n),t.leverContainer.style.visibility="visible",t.leverContainer.style.opacity="1",t.setLeverLoaded(),i||(preload_polyfill_invoke(t.leverContainer),o_util.hardcore.executeInlineScripts(t.leverContainer))}},{key:"appendAndGetLeverFor",value:function(e){var t=this,i=e.promotedDreson,n=e.featurePositionOfShoppromo,r=e.teaserPosition,o=e.pageContextDreson;return window.o_util.ajax({url:"test/benefit-presentation/lever/slideshow?dreson=".concat(i,"&featurePosition=").concat(n,"&teaserPosition=").concat(r,"&pageContextDreson=").concat(o),method:"GET"}).then((function(n){if(200===n.status){var r=window.o_util.dom.stringToDocumentFragment(n.responseText);return"tracking"===n.getResponseHeader("x-aggregation")?Promise.resolve({success:!1,status:"Benefit for ".concat(i," is used for tracking only")}):void 0!==r?(t.appendLeverToSlide(r,e),Promise.resolve({lever:r,slide:e,success:!0})):(f.warn("DocumentFragment for ".concat(i," is undefined")),Promise.resolve({success:!1,status:"DocumentFragment for ".concat(i," is undefined")}))}return f.warn("Benefit answered with ".concat(n.status," for ").concat(i)),Promise.resolve({success:!1,status:"Benefit answered with ".concat(n.status," for ").concat(i)})}))}}]),e}();window.o_promo_shoppromo=new c,window.o_global.eventLoader.onAllScriptsExecuted(95,(function(){var e,t,i,n,r,o;f.group("[FT3 promo shoppromo]"),f.count("Shoppromo Invocation"),e=document.getElementsByClassName("promo_brandshoppromo--container"),[].forEach.call(e,(function(e){"true"!==e.getAttribute("data-tracked")&&(e.setAttribute("data-tracked","true"),new d(e))})),t={containerSelector:".promo_shoppromo-small--tile-container",tileSelector:".promo_shoppromo-small--tile",buttonLeftSelector:".promo_shoppromo-small--cinema-button-left",buttonRightSelector:".promo_shoppromo-small--cinema-button-right",buttonHideClass:"promo_shoppromo-small--cinema-button-hide",tilePaddingRight:8},i=document.querySelectorAll(".promo_shoppromo-small--cinema-container"),[].forEach.call(i,(function(e){"true"!==e.getAttribute("data-initialized")&&(e.setAttribute("data-initialized","true"),new p(e,t))})),n=document.getElementsByClassName("promo_shoppromo-large--container"),r=window.o_promo_shoppromo,o=new C,[].forEach.call(n,(function(e){"false"===e.getAttribute("data-isslidingcinemaenabled")&&(e.classList.add("promo_shoppromo-large--visible"),c.loadImages(e)),"true"!==e.getAttribute("data-tracked")&&(e.setAttribute("data-tracked","true"),r.trackInitialViewLargeShopPromo(e));var t=e.querySelector(".promo_shoppromo-large--item-container");if(null!=t&&"true"!==e.getAttribute("data-initialized")){e.setAttribute("data-initialized","true");var i=t.classList.contains("promo_shoppromo-large--item-scroll-container");i&&(window.o_promo_carousels||(window.o_promo_carousels=[]),window.o_promo_carousels.push(new w(e))),o.init(e,i)}})),f.groupEnd()}))}(0,0,CustomEvent);
//# sourceMappingURL=/promo-shoppromo/assets/ft3.promo.shoppromo.098615fa.js.map
