!function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var s=function(){function e(){n(this,e)}return r(e,null,[{key:"group",value:function(e){window.o_global.debug.status().activated&&console.group&&console.group(e)}},{key:"groupEnd",value:function(){window.o_global.debug.status().activated&&console.groupEnd&&console.groupEnd()}},{key:"log",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.o_global.debug.status().activated&&console.log("[karma-assortment]: ".concat(e),t)}},{key:"warn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn&&window.o_global.debug.status().activated&&console.warn("[karma-assortment]: ".concat(e),t)}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.error&&window.o_global.debug.status().activated&&console.error("[karma-assortment]: ".concat(e),t)}},{key:"table",value:function(e){window.o_global.debug.status().activated&&console.table&&console.table(e)}},{key:"count",value:function(e){window.o_global.debug.status().activated&&console.count&&console.count(e)}}]),e}(),l=function(){function e(){n(this,e),this.tracker=window.o_tracking||{},this.tracker.bct||(this.tracker.bct={sendMergeToTrackingServer:function(){},sendEventToTrackingServer:function(){},submitMove:function(){}})}return r(e,[{key:"sendClickTrackingEvent",value:function(e){var t={};t.dynamo_ShopPromotionLarge=this._getGeneralTrackingData("click",e.offerCode,e.offerName,e.featureSequence,e.filledSlots,e.position,e.affinity,e.interactionPoint),t.dynamo_AssortmentPromoImageId=this._getImageTrackingData(e.imageId),t.dynamo_ShopPromotionScore=this._getScoreTrackingData(e.score,e.pacingFactor),t.dynamo_ShopPromoTargetPSR=this._getTargetPsrTrackingData(e.targetPsr),t.dynamo_TreatmentCode=this._getTreatmentCodeTrackingData("click",e.treatmentCode),this.tracker.bct.submitMove(t),s.log("[karma-assortment]: SubmitMove (sendClickTrackingEvent)",t)}},{key:"sendInitialViewTrackingEvent",value:function(e){var t={};t.dynamo_ShopPromotionLarge=this._getGeneralTrackingData("view",e.offerCode,e.offerName,e.featureSequence,e.filledSlots,e.position,e.affinity,e.interactionPoint),t.dynamo_AssortmentPromoImageId=this._getImageTrackingData(e.imageId),t.dynamo_ShopPromotionScore=this._getScoreTrackingData(e.score,e.pacingFactor),t.dynamo_ShopPromoTargetPSR=this._getTargetPsrTrackingData(e.targetPsr),t.dynamo_TreatmentCode=this._getTreatmentCodeTrackingData("view",e.treatmentCode),t.dynamo_AssortmentAffinity=e.campaignAffinity,this.tracker.bct.sendMergeToTrackingServer(t),s.log("[dynamo]: SendMerge (sendInitialViewTrackingEvent)",t)}},{key:"sendViewTrackingEventHidden",value:function(e){var t={};t.dynamo_ShopPromotionLarge=this._getGeneralTrackingData("view",e.offerCode,e.offerName,e.featureSequence,e.filledSlots,e.position,e.affinity,e.interactionPoint),t.dynamo_AssortmentPromoImageId=this._getImageTrackingData(e.imageId),t.dynamo_ShopPromotionScore=this._getScoreTrackingData(e.score,e.pacingFactor),t.dynamo_ShopPromoTargetPSR=this._getTargetPsrTrackingData(e.targetPsr),t.dynamo_TreatmentCode=this._getTreatmentCodeTrackingData("view",e.treatmentCode),e.movementType&&(t.dynamo_FeatureInteraction=this._getFeatureInteractionTrackingData(e.promoType,e.featureSequence,e.position,e.filledSlots,e.movementType)),this.tracker.bct.sendEventToTrackingServer(t),s.log("[dynamo]: SendEvent (sendViewTrackingEventHidden)",t)}},{key:"_getGeneralTrackingData",value:function(e,t,n,i,r,a,o,s){return t+"∞"+n+"∞"+i+"∞"+r+"∞"+a+"∞"+o+"∞"+s+"∞"+e}},{key:"_getScoreTrackingData",value:function(e,t){return e+"∞"+t}},{key:"_getImageTrackingData",value:function(e){return e}},{key:"_getTargetPsrTrackingData",value:function(e){return e}},{key:"_getTreatmentCodeTrackingData",value:function(e,t){return t+"∞"+e}},{key:"_getEventAsString",value:function(e,t,n,i,r,a,o){return e+"∞"+t+"$"+(n+1)+"∞"+i+"∞"+r+"∞"+a+"∞"+o}},{key:"_getFeatureInteractionTrackingData",value:function(e,t,n,i,r){return e+"∞"+t+"∞"+i+"∞"+r}},{key:"_buildClickTrackingPayload",value:function(e,t,n,i,r,a,o,s){var l={};return l["karma_"+e]=this._getEventAsString(t,n,i,r,a,o,s),l["wk.karma_Attribution"]="karma_"+e+"∞"+this._getEventAsString(t,n,i,r,a,o,s),l}}]),e}(),c=function(){function e(){n(this,e),this.trackingService=new l}return r(e,[{key:"trackClick",value:function(e,t,n,i){var r=t+1,a=this.findParentContainer(e,i),o=a.querySelectorAll(".karma_assortment--item")[r],s=this.parseHtmlTrackingData(a,o,n,t);this.trackingService.sendClickTrackingEvent(s)}},{key:"getDestinationUrl",value:function(e){return e.getAttribute("href")}},{key:"trackInitialView",value:function(e){var t=this.getSourceUrls(e).length,n=e.querySelectorAll(".karma_assortment--item")[0];if(void 0!==n){var i=this.parseHtmlTrackingData(e,n,t,null);n.setAttribute("data-slidetracked","true"),this.trackingService.sendInitialViewTrackingEvent(i)}else s.error("No first slide but request to track initial view.")}},{key:"trackSlide",value:function(e,t,n){var i=this.getSourceUrls(e).length-2,r=e.querySelectorAll(".karma_assortment--item")[t],a=this.parseHtmlTrackingData(e,r,i,null,n);this.trackingService.sendViewTrackingEventHidden(a)}},{key:"parseHtmlTrackingData",value:function(e,t,n,i,r){var a=t.getAttribute("data-feature-index"),o=null!=i?i:parseInt(null!==a?a:"-1",0);return{featureSequence:parseInt(e.parentElement.getAttribute("data-feature-order"),0),offerCode:t.getAttribute("data-offer-code"),offerName:t.getAttribute("data-offer-name"),affinity:t.getAttribute("data-offer-affinity"),campaignAffinity:t.getAttribute("data-campaign-affinity"),interactionPoint:t.getAttribute("data-offer-interaction-point"),imageId:t.getAttribute("data-promo-imageId"),score:t.getAttribute("data-offer-score"),pacingFactor:t.getAttribute("data-offer-pacing-factor"),targetPsr:t.getAttribute("data-offer-target-psr"),treatmentCode:t.getAttribute("data-offer-treatment-code"),promoType:e.getAttribute("data-promo-type"),filledSlots:n,position:++o,movementType:r}}},{key:"getSourceUrls",value:function(e,t,n,i){var r=e.querySelectorAll(".karma_assortment--image-container");return n=n||0,i=i||r.length,[].map.call(r,(function(e){return e.getAttribute("data-image-source-type")||"manual"})).slice(n,i)}},{key:"getAllDestinationUrls",value:function(e,t,n,i){var r=e.querySelectorAll(".karma_assortment--image-container a");return n=n||0,i=i||r.length,[].map.call(r,(function(e){return e.getAttribute("href")})).slice(n,i)}},{key:"findParentContainer",value:function(e,t){for(;!e.classList.contains("karma_assortment--container")&&(e=e.parentElement););return e}}],[{key:"loadImages",value:function(e){for(var t=e.querySelectorAll(".karma_assortment--image"),n=e.querySelectorAll(".karma_assortment--picture source"),i=e.querySelectorAll(".karma_assortment--logo"),r=0;r<t.length;r++)t[r].getAttribute("data-src")&&t[r].setAttribute("src",t[r].getAttribute("data-src"));for(var a=0;a<n.length;a++)n[a].getAttribute("data-srcset")&&n[a].setAttribute("srcset",n[a].getAttribute("data-srcset"));for(var o=0;o<i.length;o++)i[o].getAttribute("data-src")&&i[o].setAttribute("src",i[o].getAttribute("data-src"))}}]),e}();var d={slidesToScroll:1,slideSpeed:300,rewindSpeed:600,snapBackSpeed:200,ease:"ease",rewind:!1,infinite:!1,initialIndex:0,classNameFrame:"js_frame",classNameSlideContainer:"js_slides",classNamePrevCtrl:"js_prev",classNameNextCtrl:"js_next",classNameActiveSlide:"active",enableMouseEvents:!1,window:"undefined"!=typeof window?window:null,rewindOnResize:!0},u=Array.prototype.slice;function m(e,n){var i,r,s,l,c,m,v,f,h,g,p,y,k,b=0,S={},w=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return e}()&&{passive:!0};function _(e,t){var n=S.classNameActiveSlide;e.forEach((function(e,t){e.classList.contains(n)&&e.classList.remove(n)})),e[t].classList.add(n)}function E(n,i,r){!function(e,n,i){var r=new t(n,{bubbles:!0,cancelable:!0,detail:i});e.dispatchEvent(r)}(e,"".concat(n,".lory.").concat(i),r)}function C(e,t,n){var i=m&&m.style;i&&(i[h.transition+"TimingFunction"]=n,i[h.transition+"Duration"]=t+"ms",i[h.transform]="translateX("+e+"px)")}function L(e){return e.getBoundingClientRect().width||e.offsetWidth}function A(e,t){var n=S,a=n.slideSpeed,o=n.slidesToScroll,c=n.infinite,d=n.rewind,m=n.rewindPrev,h=n.rewindSpeed,p=n.ease,y=n.classNameActiveSlide,k=n.classNameDisabledNextCtrl,w=void 0===k?"disabled":k,L=n.classNameDisabledPrevCtrl,A=void 0===L?"disabled":L,T=a,D=t?b+1:b-1,I=Math.round(r-s);E("before","slide",{index:b,nextSlide:D}),v&&v.classList.remove(A),f&&f.classList.remove(w),"number"!=typeof e&&(e=t?c&&b+2*c!==l.length?b+(c-b%c):b+o:c&&b%c!=0?b-b%c:b-o),e=Math.min(Math.max(e,0),l.length-1),c&&void 0===t&&(e+=c),m&&0===Math.abs(i.x)&&!1===t&&(e=l.length-1,T=h);var P=Math.min(Math.max(-1*l[e].offsetLeft,-1*I),0);d&&Math.abs(i.x)===I&&t&&(P=0,e=0,T=h),C(P,T,p),i.x=P,l[e].offsetLeft<=I&&(b=e),!c||e!==l.length-c&&e!==l.length-l.length%c&&0!==e||(t&&(b=c),t||(b=l.length-2*c),i.x=-1*l[b].offsetLeft,g=function(){C(-1*l[b].offsetLeft,0,void 0)}),y&&_(u.call(l),b),!v||c||m||0!==e||v.classList.add(A),!f||c||d||e+1!==l.length||f.classList.add(w),E("after","slide",{currentSlide:b})}function T(){var t,r,s,g,p,y;E("before","init"),p=document.createElement("_"),""===(y=p.style)[g="webkitTransition"]&&(s="webkitTransitionEnd",r=g),""===y[g="transition"]&&(s="transitionend",r=g),""===y[g="webkitTransform"]&&(t=g),""===y[g="msTransform"]&&(t=g),""===y[g="transform"]&&(t=g),document.body.insertBefore(p,null),y[t]="translateX(0)",document.body.removeChild(p),h={transform:t,transition:r,transitionEnd:s};var k,C,L,A,T=S=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},d,{},n),N=T.classNameFrame,q=T.classNameSlideContainer,O=T.classNamePrevCtrl,j=T.classNameNextCtrl,W=T.classNameDisabledNextCtrl,z=void 0===W?"disabled":W,G=T.classNameDisabledPrevCtrl,H=void 0===G?"disabled":G,R=T.enableMouseEvents,V=T.classNameActiveSlide,X=T.initialIndex;b=X,c=e.getElementsByClassName(N)[0],m=c.getElementsByClassName(q)[0],v=e.getElementsByClassName(O)[0],f=e.getElementsByClassName(j)[0],i={x:m.offsetLeft,y:m.offsetTop},S.infinite?(k=u.call(m.children),C=S.infinite,L=k.slice(0,C),A=k.slice(k.length-C,k.length),L.forEach((function(e){var t=e.cloneNode(!0);m.appendChild(t)})),A.reverse().forEach((function(e){var t=e.cloneNode(!0);m.insertBefore(t,m.firstChild)})),m.addEventListener(h.transitionEnd,x),l=u.call(m.children)):(l=u.call(m.children),v&&!S.rewindPrev&&v.classList.add(H),f&&1===l.length&&!S.rewind&&f.classList.add(z)),D(),V&&_(l,b),v&&f&&(v.addEventListener("click",I),f.addEventListener("click",P)),c.addEventListener("touchstart",M,w),R&&(c.addEventListener("mousedown",M),c.addEventListener("click",F)),S.window.addEventListener("resize",B),E("after","init")}function D(){var e=S,t=e.infinite,n=e.ease,a=e.rewindSpeed,o=e.rewindOnResize,d=e.classNameActiveSlide,v=e.initialIndex;r=L(m),s=L(c),function(e,t,n){return Math.abs(e-t)<n}(r,s,.99)&&(r=l.reduce((function(e,t){return e+L(t)}),0)),o?b=v:(n=null,a=0),t?(C(-1*l[b+t].offsetLeft,0,null),b+=t,i.x=-1*l[b].offsetLeft):(C(-1*l[b].offsetLeft,a,n),i.x=-1*l[b].offsetLeft),d&&_(u.call(l),b)}function I(){A(!1,!1)}function P(){A(!1,!0)}function x(){g&&(g(),g=void 0)}function M(e){var t=S.enableMouseEvents,n=e.touches?e.touches[0]:e;t&&(c.addEventListener("mousemove",N),c.addEventListener("mouseup",q),c.addEventListener("mouseleave",q)),c.addEventListener("touchmove",N,w),c.addEventListener("touchend",q);var i=n.pageX,r=n.pageY;p={x:i,y:r,time:Date.now()},k=void 0,y={},E("on","touchstart",{event:e})}function N(e){var t=e.touches?e.touches[0]:e,n=t.pageX,r=t.pageY;y={x:n-p.x,y:r-p.y},void 0===k&&(k=!!(k||Math.abs(y.x)<Math.abs(y.y))),!k&&p&&C(i.x+y.x,0,null),E("on","touchmove",{event:e})}function q(e){var t=p?Date.now()-p.time:void 0,n=Number(t)<300&&Math.abs(y.x)>25||Math.abs(y.x)>s/3,r=!b&&y.x>0||b===l.length-1&&y.x<0,a=y.x<0;k||(n&&!r?A(!1,a):C(i.x,S.snapBackSpeed)),p=void 0,c.removeEventListener("touchmove",N),c.removeEventListener("touchend",q),c.removeEventListener("mousemove",N),c.removeEventListener("mouseup",q),c.removeEventListener("mouseleave",q),E("on","touchend",{event:e})}function F(e){y.x&&e.preventDefault()}function B(e){s!==L(c)&&(D(),E("on","resize",{event:e}))}return"undefined"!=typeof jQuery&&e instanceof jQuery&&(e=e[0]),T(),{setup:T,reset:D,slideTo:function(e){A(e)},returnIndex:function(){return b-S.infinite||0},prev:I,next:P,destroy:function(){E("before","destroy"),c.removeEventListener(h.transitionEnd,x),c.removeEventListener("touchstart",M,w),c.removeEventListener("touchmove",N,w),c.removeEventListener("touchend",q),c.removeEventListener("mousemove",N),c.removeEventListener("mousedown",M),c.removeEventListener("mouseup",q),c.removeEventListener("mouseleave",q),c.removeEventListener("click",F),S.window.removeEventListener("resize",B),v&&v.removeEventListener("click",I),f&&f.removeEventListener("click",P),S.infinite&&Array.apply(null,Array(S.infinite)).forEach((function(){m.removeChild(m.firstChild),m.removeChild(m.lastChild)})),E("after","destroy")},setSlideSpeed:function(e){S.slideSpeed=e}}}var v=function(){function e(t){n(this,e),this.cinemaDom=t,this.xDown=null,this.yDown=null}return r(e,[{key:"init",value:function(){if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){var e=this;this.cinemaDom.addEventListener("touchstart",(function(t){return e.handleTouchStart(t)}),{passive:!0}),this.cinemaDom.addEventListener("touchmove",(function(t){return e.handleTouchMove(t)}),{passive:!1})}}},{key:"handleTouchStart",value:function(e){var t=e.touches[0];this.xDown=t.clientX,this.yDown=t.clientY}},{key:"handleTouchMove",value:function(e){if(this.xDown&&this.yDown){var t=e.touches[0].clientX,n=e.touches[0].clientY,i=this.xDown-t,r=this.yDown-n;Math.abs(i)>Math.abs(r)&&e.preventDefault(),this.xDown=null,this.yDown=null}}}]),e}(),f=function(){function e(t){var i=this;n(this,e);var r=this;this.slideCount=t.querySelectorAll(".karma_assortment--item").length,s.log("Initialize assortment with ".concat(this.slideCount," slides")),this.moveEvent="automatic",this.dots=t.querySelectorAll(".karma_assortment--bubble-container-item"),this.buttons=t.querySelectorAll(".karma_assortment--arrow-container > div"),this.leftButton=t.querySelector(".karma_assortment--cinema-button-left"),this.rightButton=t.querySelector(".karma_assortment--cinema-button-right"),this.dot_count=this.dots.length,this.slider=null,this.autoSlideIntervalMillis=5e3,this.lastAutoSlideTimeMillis=0,this.slideSpeed=1500,this.slideSpeedAfterFirstClick=380,this.automaticSlidingIntervalId=null,this.picturecontainers=null,this.lastClickTimeMillis=0,this.cinemaDom=t,this.assortment=window.o_karma_assortment,this.slideCount>1?(this.carouselIosBridge=new v(t),this.cinemaDom.addEventListener("before.lory.init",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("on.lory.touchstart",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("after.lory.init",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("after.lory.slide",(function(e){return r.handleSliderEvent(e,r)})),this.cinemaDom.addEventListener("on.lory.resize",(function(e){return r.handleSliderEvent(e,r)})),[].forEach.call(this.buttons,(function(e){return e.addEventListener("click",(function(e){return r.handleClickEvent(e)}))})),this.leftButton.addEventListener("click",(function(){return i.moveEvent="left"})),this.rightButton.addEventListener("click",(function(){return i.moveEvent="right"})),[].forEach.call(this.dots,(function(e){return e.addEventListener("click",(function(){return i.moveEvent="page_control"}))})),this.addMouseMovementListenerForHybridDevices()):(t.querySelector(".karma_assortment--bubble-container").style.visibility="hidden",this.leftButton.style.visibility="hidden",this.rightButton.style.visibility="hidden"),this.initLory(),this.initCarouselWhenCssAndFirstImageAreLoaded(),o_global.shoppromo_carousel=this}return r(e,[{key:"handleSliderEvent",value:function(e){var t=this;if("before.lory.init"===e.type)this.dots[0].classList.add("active");else if("after.lory.init"===e.type)for(var n=0;n<this.dot_count;n++)this.dots[n].addEventListener("click",(function(e){return t.slideTo(e)}));else if("after.lory.slide"===e.type){for(var i=0;i<this.dot_count;i++)this.dots[i].classList.remove("active");this.dots[e.detail.currentSlide-1].classList.add("active"),this.trackSlidingEvent(e)}else if("on.lory.resize"===e.type){for(var r=0;r<this.dot_count;r++)this.dots[r].classList.remove("active");this.dots[0].classList.add("active"),this.slider.reset()}else"on.lory.touchstart"===e.type&&(this.stopAutomaticSliding(),this.moveEvent="swipe",this.slider.setSlideSpeed(t.slideSpeedAfterFirstClick))}},{key:"slideTo",value:function(e){this.stopAutomaticSliding(),this.slider.slideTo(Array.prototype.indexOf.call(this.dots,e.target))}},{key:"trackSlidingEvent",value:function(e){var t=this.cinemaDom.querySelector(".karma_assortment--item.active");"true"===t.getAttribute("data-slidetracked")&&"automatic"===this.moveEvent||(t.setAttribute("data-slidetracked","true"),this.assortment.trackSlide(this.cinemaDom,e.detail.currentSlide,this.moveEvent))}},{key:"handleClickEvent",value:function(e){this.stopAutomaticSliding(),this.slider.setSlideSpeed(this.slideSpeedAfterFirstClick);var t=(new Date).getTime();if(this.lastClickTimeMillis+this.slideSpeedAfterFirstClick>=t)return e.preventDefault(),void e.stopImmediatePropagation();this.lastClickTimeMillis=t}},{key:"stopAutomaticSliding",value:function(){null!==this.automaticSlidingIntervalId&&(window.clearInterval(this.automaticSlidingIntervalId),this.automaticSlidingIntervalId=null)}},{key:"addMouseMovementListenerForHybridDevices",value:function(){var e=this,t=function t(){e.leftButton.style.visibility="visible",e.rightButton.style.visibility="visible",e.cinemaDom.removeEventListener("mouseover",t,!1)};this.cinemaDom.addEventListener("mouseover",t,!1),this.cinemaDom.addEventListener("touchstart",(function n(){e.cinemaDom.removeEventListener("mouseover",t,!1),e.cinemaDom.removeEventListener("touchstart",n,!1)}),{passive:!0})}},{key:"initLory",value:function(){this.slider=m(this.cinemaDom,{infinite:this.slideCount>1&&1,slideSpeed:this.slideSpeed,classNameFrame:"karma_assortment--scroll-pane",classNameSlideContainer:"karma_assortment--item-container",classNamePrevCtrl:"karma_assortment--cinema-button-left",classNameNextCtrl:"karma_assortment--cinema-button-right"}),this.slideCount>1&&this.carouselIosBridge.init()}},{key:"initCarouselWhenCssAndFirstImageAreLoaded",value:function(){var e=this,t=window.setInterval((function(){var n=getComputedStyle(e.cinemaDom),i=n?n.zIndex:"-42",r=e.cinemaDom.className.indexOf("--visible")>0,a="-42"===i||i+""=="-42"||r;s.log("Carousel: zIndex: "+i+" - promoAlreadyVisible: "+r+" - isCssLoadedAndApplied: "+a),a&&(s.log("Carousel: Clearing interval "+t+" and call onCssLoaded"),window.clearInterval(t),e.onCssLoaded())}),50)}},{key:"onCssLoaded",value:function(){var e=this,t=this.cinemaDom.querySelectorAll(".karma_assortment--image-first")[0];if(this.picturecontainers=this.cinemaDom.querySelectorAll(".karma_assortment--picturecontainer"),!t)return s.log("Carousel: Cinema Shoppromo contains no images - this should not happen."),void this.cinemaDom.classList.add("karma_assortment--visible");if(c.loadImages(this.cinemaDom),t.complete)s.log("Carousel: First image is complete - calling onCssAndFirstImageLoaded..."),this.resetCarouselWhenWidthIsGreaterZero();else{s.log("Carousel: First image is not complete - registering event listeners for load and error on firstImage: "+t);var n=o_global.device.browser;"MSIE10"===n||"MSIE9"===n?this.resetCarouselWhenWidthIsGreaterZero():(t.addEventListener("load",(function(){return e.resetCarouselWhenWidthIsGreaterZero()})),t.addEventListener("error",(function(){return e.resetCarouselWhenWidthIsGreaterZero()})))}}},{key:"resetCarouselWhenWidthIsGreaterZero",value:function(){var e=this,t=this.cinemaDom.querySelectorAll(".karma_assortment--item-container")[0],n=t.getBoundingClientRect().width||t.offsetWidth;if(n<=0)var i=window.setInterval((function(){var n=t.getBoundingClientRect().width||t.offsetWidth;s.log("Carousel: width: "+n),n<=0||(s.log("Carousel: width is "+n+" - Clearing interval "+i+" and resetting carousel"),window.clearInterval(i),e.resetCarousel())}),50);else s.log("Carousel: Has right width ("+n+") from the beginning. Resetting carousel."),this.resetCarousel()}},{key:"resetCarousel",value:function(){this.slider.reset(),this.cinemaDom.classList.add("karma_assortment--visible"),window.localStorage&&"true"===window.localStorage.getItem("stopSlidingCinemaForJLineup")||(this.automaticSlidingIntervalId=window.setInterval(this.performSlide(),this.autoSlideIntervalMillis))}},{key:"performSlide",value:function(){var e=this;return function(){var t=(new Date).getTime(),n=null!=document.getElementById("p_layer");e.lastAutoSlideTimeMillis+e.autoSlideIntervalMillis<=t&&!n&&(e.slider.next(),e.lastAutoSlideTimeMillis=t)}}}]),e}(),h=function(){function e(t){n(this,e),this.slideContainer=t,this.leverContainer=t.querySelector(".karma_assortment--benefits-container"),this.ctaContainer=t.querySelector(".karma_assortment--cta-container"),this.leverLoaded=this.leverContainer.getAttribute("data-promo-lever-loaded"),this.promotedDreson=t.getAttribute("data-promo-dreson"),this.featurePositionOfShoppromo=this._getFeatureOrder(),this.teaserPosition=-1,this.pageContextDreson=this._getPageContextDreson()}return r(e,[{key:"setLeverLoaded",value:function(){this.leverContainer.setAttribute("data-promo-lever-loaded","true"),this.leverLoaded=!0}},{key:"_getFeatureOrder",value:function(){for(var e=this.slideContainer;e&&!e.getAttribute("data-feature-order");)e=e.parentElement;return e?parseInt(e.getAttribute("data-feature-order")):-1}},{key:"_getPageContextDreson",value:function(){for(var e=this.slideContainer;e&&!e.getAttribute("data-context-dreson");)e=e.parentElement;return e?e.getAttribute("data-context-dreson"):""}},{key:"withTeaserPosition",value:function(e){return this.teaserPosition=e,this}}]),e}(),g=function(){function e(){n(this,e)}return r(e,[{key:"init",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.querySelectorAll(".karma_assortment--item"),r=[].map.call(i,(function(e){return new h(e)})),a=n?r.slice(1,r.length-1):r,o=a.filter((function(e){return-1===e.promotedDreson.indexOf("(ref.")})).filter((function(e){return"false"===e.leverLoaded})).map((function(e,n){return t.appendAndGetLeverFor(e.withTeaserPosition(n+1))}));n&&o.length>0&&this.appendLeverToBuffer(r,o)}},{key:"appendLeverToBuffer",value:function(e,t){var n=this,i=e[0],r=e[e.length-1];t[0].then((function(e){e.success&&e.slide.promotedDreson===r.promotedDreson&&n.appendLeverToSlide(e.lever,r,!0)})),t[t.length-1].then((function(e){e.success&&e.slide.promotedDreson===i.promotedDreson&&n.appendLeverToSlide(e.lever,i,!0)}))}},{key:"appendLeverToSlide",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.cloneNode(!0);if(n){var r=i.querySelector(".benefit_lever.benefit_lever_slideshow");r.setAttribute("data-tracked",!0)}t.ctaContainer.style.visibility="hidden",t.leverContainer.appendChild(i),t.leverContainer.style.visibility="visible",t.leverContainer.style.opacity="1",t.setLeverLoaded(),n||(preload_polyfill_invoke(t.leverContainer),o_util.hardcore.executeInlineScripts(t.leverContainer))}},{key:"appendAndGetLeverFor",value:function(e){var t=this,n=e.promotedDreson,i=e.featurePositionOfShoppromo,r=e.teaserPosition,a=e.pageContextDreson;return window.o_util.ajax({url:"/benefit-presentation/lever/slideshow?dreson=".concat(n,"&featurePosition=").concat(i,"&teaserPosition=").concat(r,"&pageContextDreson=").concat(a),method:"GET"}).then((function(i){if(200===i.status){var r=window.o_util.dom.stringToDocumentFragment(i.responseText);return"tracking"===i.getResponseHeader("x-aggregation")?Promise.resolve({success:!1,status:"Benefit for ".concat(n," is used for tracking only")}):void 0!==r?(t.appendLeverToSlide(r,e,!1),Promise.resolve({lever:r,slide:e,success:!0})):(s.warn("DocumentFragment for ".concat(n," is undefined")),Promise.resolve({success:!1,status:"DocumentFragment for ".concat(n," is undefined")}))}return s.warn("Benefit answered with ".concat(i.status," for ").concat(n)),Promise.resolve({success:!1,status:"Benefit answered with ".concat(i.status," for ").concat(n)})}))}}]),e}();window.o_karma_assortment=new c,window.o_global.eventLoader.onAllScriptsExecuted(96,(function(){var e,t,n;e=document.getElementsByClassName("karma_assortment--container"),t=window.o_karma_assortment,n=new g,[].forEach.call(e,(function(e){"true"!==e.getAttribute("data-tracked")&&(e.setAttribute("data-tracked","true"),t.trackInitialView(e));var i=e.querySelector(".karma_assortment--item-container");if(null!=i){if(i.querySelectorAll(".karma_assortment--item").length<1)return void s.error("Try to initialize assortment teaser with less than 1 element.");if("true"!==e.getAttribute("data-initialized")){e.setAttribute("data-initialized","true");var r=i.classList.contains("karma_assortment--item-scroll-container");r&&(window.o_promo_carousels||(window.o_promo_carousels=[]),window.o_promo_carousels.push(new f(e))),n.init(e,r)}}}))}))}(0,CustomEvent);
//# sourceMappingURL=/karma-assortment/assets/ft9.karma-assortment.ft9_kestrel_bundle.1ceb752a.js.map
